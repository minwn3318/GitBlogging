# Memory
## Memory
AI 에이전트가 이전 상태나 대화 기록을 유지하고 재사용할 수 있도록 하는 기능
- 지속적 맥락 유지
- 세션 메모리 뿐만 아니라 외부 저장소를 활용하여 장기적인 상태를 저장
- **기억 정보를 제어하기 위한 로직을 넣을 수 있음**

### 두 가지 종류의 메모리**
1. MemorySaver : memory
2. SqliteSaver : file, db

---
## MemorySaver
LangGraph에서 제공하는 체크포인트 저장소
- 그래프 실행 중 생성되는 상태를 자동으로 정하고 필요시 복원할 수 있게 함

**주요특징**
- 용도 :
    그래프의 실행 상태를 저장하고 복원
- 저장위치 :
    램 안에 저장
- 사용방식 :
    LangGrph copile 시 checkpointer로 넘김
- 이어서 실행 :
    이전 실행의 마지막 상태부터 재실행 가능
- 한계 :
    세션이 종료되면 자장된 상태는 사라짐

---
## sqlitsaver
langGraph에서 wprhdgksms 
---
## Memory 활용
**메시지를 계속 쌓을 때 생기는 문제 3가지**
1. 텍스트 초과 오류
    - 토큰 한계
    - 이전 대화 짤림
2. 속도 저하 & 비용 증가
    - api 비용 늘어남
    - 처리 시간이 느려짐
3. 답변이 모호해짐
    - gpt가 최근보다 과거메시지에 주목하게 됨
    - 엉뚱한 답변이 나옴

**해결방안**
1. 최근 메시지만 기억
    - 최근 몇개의 메시지만 넘겨서 대화 문맥을 간려하게 유지 - 슬라이싱
2. 오래된 메시지 요약
    - 메세지가 특정 갯수까지 차면 요약해서 기록하고 앞의 내용은 삭제하기

### 스레드와의 관계
- 메모리가 있어야 기억을 할 수 있음
- 스레드가 있어야 기억들을 관리할 수 있음

### 메모리 세이버 알아야 하는 것
- 메세지 세이버 선언 후 컴파일러에 추가
- 스레드 아이디를 지정하고 대화를 함
- 메모리 사용시 스테이트[메시지]에 메시지가 쌓인다
- 언어모델 입력 (프롬프트)는 기본적으로 state[메시지] 전부